\documentclass[12pt]{article}
\usepackage{mathpazo, amsmath, amssymb, amsfonts, amsthm, microtype, tikz, titling, graphicx, booktabs, caption, subcaption, bm, xfrac, appendix, setspace, comment, float, nth, fnpct, makecell, multirow, tabularx, threeparttable, titling, array, lipsum, mathtools, tocloft, tocvsec2}
\usepackage[margin=2.75cm]{geometry}
\renewcommand{\baselinestretch}{1.15}
\renewcommand{\arraystretch}{2}
\setlength\droptitle{-2.5cm}
%\setlength\parindent{0cm}
\setlength{\parskip}{0.15cm}
\definecolor{HEC}{rgb}{0, 0.1569, 0.3333}
\usepackage[colorlinks, allcolors=HEC]{hyperref}
\urlstyle{rm}
\captionsetup[figure]{labelfont={color=HEC}}
\captionsetup[table]{labelfont={color=HEC}}
\usepackage[ruled, vlined]{algorithm2e}
\setlength{\abovecaptionskip}{0.5cm}
\usepackage[longnamesfirst]{natbib}

% Command to reference subfigures
\renewcommand{\thesubfigure}{(\alph{subfigure})}
\captionsetup[sub]{labelformat=simple}

% Define the path for the figures
\graphicspath{{../../Figures/}}

% Define a command and the path for the tables
\newcommand*\includetables[1]{\input{../../Tables/#1.tex}}

% Do not add sections of the main text to the appendix's table of content
\addtocontents{toc}{\protect\setcounter{tocdepth}{-1}}

% Command to comment within lines
\newcommand{\ignore}[1]{}

% Command to center table columns
\newcolumntype{C}[1]{>{\centering\arraybackslash}p{#1}}
\newlength\mcwidth

% Mathematical commands
\DeclareMathOperator*{\argmax}{arg\,max}
\newcommand{\diag}[1]{\text{diag}\left(#1\right)}
\newcommand{\partialof}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\totalof}[2]{\frac{\mathrm{d} #1}{\mathrm{d} #2}}
\newcommand{\deltaof}[3]{\delta #1 [#2; #3]}
\newcommand{\innerprod}[3]{\langle #1, #2 \rangle_{#3}}
\newtheorem{theorem}{Theorem}
\newtheorem{corollary}{Corollary}
\newtheorem{definition}{Definition}
\newtheorem{proposition}{Proposition}
\newtheorem{lemma}{Lemma}

% Command to resize equations
\newcommand{\resizeeq}[2]{\resizebox{#2\hsize}{!}{$#1$}}

% Command to make a small horizontal space
\newcommand{\smallquad}{\hspace{0.5em}}

% Title
\title{\textbf{Entry Misallocation and \\Heterogeneous Love of Variety}\thanks{We are grateful to ZZZ.}}
\author{\href{https://www.jeanfelixbrouillette.com}{Jean-F\'elix Brouillette}\textsuperscript{1}}
\date{\today}

\begin{document}

\maketitle

\footnotetext[1]{HEC Montr\'eal. E-mail: \href{mailto:jean-felix.brouillette@hec.ca}{jean-felix.brouillette@hec.ca}}

\begin{abstract}
\end{abstract}

\clearpage

\section{Introduction}
\label{s:introduction}

\subsection*{Literature review}
\label{s:literature review}

\section{Theoretical framework}
\label{s:theoretical framework}

\subsection{Economic environment}
\label{section:economic environment}

\paragraph{Preferences.} Consider an economy populated by an infinitely-lived representative household of measure $N_t$ with logarithmic preferences over consumption:
\begin{equation}
    U = \int_0^{\infty} e^{-(\rho - n) t} \ln(c_t) \mathrm{d}t \quad \text{where} \quad c_t \equiv \frac{C_t}{N_t} \label{eq:lifetime utility}
\end{equation}
and where $\rho > 0$ is the rate of time preference. In particular, aggregate consumption $C_t$ is a Cobb-Douglas aggregate of sectoral consumption bundles from $S \in \mathbb{N}$ sectors indexed by $s \in \{1, \ldots, S\}$:
\begin{equation}
    C_t = \prod_{s = 1}^S C_{st}^{\beta_s} \quad \text{where} \quad \sum_{s = 1}^S \beta_s = 1. \label{eq:aggregate consumption}
\end{equation}
Within each sector, the household consumes a bundle of products indexed by $i$:
\begin{equation}
    C_{st} = \left(M_{st}^{-1 / \theta} \int_0^{M_{st}} C_{ist}^{\frac{\theta - 1}{\theta}} \mathrm{d}i\right)^{\frac{\theta}{\theta - 1}} \label{eq:sectoral consumption}
\end{equation}
where $C_{ist}$ is the consumed quantity of product $i$ from sector $s$, $M_{st}$ is the measure of products in that sector and $\theta > 1$ is the elasticity of substitution between those products. The representative household inelastically supplies $L_t^P \equiv \mathcal{S}^P \cdot N_t$ units of production labor and $L_t^E \equiv \mathcal{S}^E \cdot N_t$ units of entry labor where $\mathcal{S}^P + \mathcal{S}^E = 1$ and $\mathcal{S}^P, \mathcal{S}^E > 0$.

\paragraph{Production technology.} Each sector $s$ is composed of $M_{st}$ firms producing a single product $i$ using production labor $l_{ist}$ and a bundle $x_{ist}$ of products from other sectors:
\begin{align}
    \begin{split}
    y_{ist} = x_{ist}^{\alpha_s} l_{ist}^{1 - \alpha_s} \quad \text{where} \quad x_{ist} &= \prod_{k = 1}^S x_{ist}(k)^{\omega_{sk}} \\
    \text{and} \quad x_{ist}(k) &= M_{kt}^{\psi_{sk}} \left(M_{kt}^{-1 / \theta} \int_0^{M_{kt}} x_{ist}(j, k)^{\frac{\theta - 1}{\theta}} \mathrm{d}j\right)^{\frac{\theta}{\theta - 1}}. \label{eq:production technology}
    \end{split}
\end{align}
Here, $y_{ist}$ is the output of firm $i$ from sector $s$ and $x_{ist}(j, k)$ is the quantity of product $j$ from sector $k$ demanded by firm $i$ from sector $s$. The parameter $\alpha_s \in (0, 1)$ is the output elasticity of intermediate inputs in sector $s$ and $\omega_{sk}$ measures the importance of intermediate inputs from sector $k$ in the production technology of sector $s$, which are collected in the matrix $\bm{\Omega}$. In particular, we have:
\begin{equation*}
    \sum_{k = 1}^S \omega_{sk} = 1.
\end{equation*}
Finally, $\psi_{sk} > 0$ measures the strength of the taste for variety by sector $s$'s firms for products from sector $k$, which are collected in the matrix $\bm{\Psi}$. This formulation developed by \citet{Benassy_1996} isolates the ``taste for variety'' from the elasticity of substitution between products.

\paragraph{Entry technology.} In every point in time, a unit measure of potential entrants in each sector attempt to introduce new products. Specifically, these entrants can direct $1 / \epsilon_s$ units of labor to entry in order to create a unit flow of these new products. Hence, the evolution of the measure of products in sector $s$ is given by:
\begin{equation}
    \dot{M}_{st} = \epsilon_s L_{st}^E. \label{eq:entry technology}
\end{equation}

\paragraph{Resource constraints.} The resource constraints for the products of each sector are given by:
\begin{equation}
    C_{ist} + \sum_{k = 1}^S \int_0^{M_{kt}} x_{jkt}(i, s) \mathrm{d}j \leq y_{ist} \quad \forall i \in M_{st} \quad \forall s \in \{1, \ldots, S\}, \label{eq:product resource constraints}
\end{equation}
the resource constraint for production labor is given by:
\begin{equation}
    \sum_{s = 1}^S \int_0^{M_{st}} l_{ist} \mathrm{d}i \leq L_t^P, \label{eq:production labor resource constraint}
\end{equation}
and the resource constraint for entry labor is given by:
\begin{equation}
    \sum_{s = 1}^S L_{st}^E \leq L_t^E. \label{eq:entry labor resource constraint}
\end{equation}
Finally, the population grows at constant rate $n > 0$:
\begin{equation}
    \dot{N}_t = n \cdot N_t. \label{eq:population}
\end{equation}
The economic environment is summarized in Table \ref{tab:environment}.

\begin{table}[h!]
    \centering
    \caption{The economic environment}
    \resizebox{\textwidth}{!}{
    \begin{tabular}{lll}
    \hline
    \hline
    \eqref{eq:lifetime utility} & $U = \int_0^{\infty} e^{-(\rho - n) t} \ln(C_t / N_t) \mathrm{d}t$ & Lifetime utility \\
    \eqref{eq:aggregate consumption} & $C_t = \prod_{s = 1}^S C_{st}^{\beta_s}$ & Aggregate consumption \\
    \eqref{eq:sectoral consumption} & $C_{st} = (M_{st}^{-1 / \theta} \int_0^{M_{st}} C_{ist}^{\frac{\theta - 1}{\theta}} \mathrm{d}i)^{\frac{\theta}{\theta - 1}}$ & Sectoral consumption \\
    \eqref{eq:production technology} & $y_{ist} = \prod_{k = 1}^S [M_{kt}^{\psi_{sk}} (M_{kt}^{-1 / \theta} \int_0^{M_{kt}} x_{ist}(j, k)^{\frac{\theta - 1}{\theta}} \mathrm{d}j)^{\frac{\theta}{\theta - 1}}]^{\omega_{sk} \alpha_s} l_{ist}^{1 - \alpha_s}$ & Production technology \\
    \eqref{eq:entry technology} & $\dot{M}_{st} = \epsilon_s L_{st}^E$ & Entry technology \\
    \eqref{eq:product resource constraints} & $C_{ist} + \sum_{k = 1}^S \int_0^{M_{kt}} x_{jkt}(i, s) \mathrm{d}j \leq y_{ist}$ & Product resources \\
    \eqref{eq:production labor resource constraint} & $\sum_{s = 1}^S \int_0^{M_{st}} l_{ist} \mathrm{d}i \leq L_t^P$ & Production labor resources \\
    \eqref{eq:entry labor resource constraint} & $\sum_{s = 1}^S L_{st}^E \leq L_t^E$ & Entry labor resources \\
    \eqref{eq:population} & $\dot{N}_t = n \cdot N_t$ & Population growth \\
    \hline
    \hline
    \end{tabular}}
    \label{tab:environment}
\end{table}

\subsection{The market equilibrium allocation}

In Appendix \ref{a:market equilibrium allocation}, we derive the market equilibrium allocation of this economy. In particular, we show that on a balanced growth path, the share of production labor allocated to each sector is given by:
\begin{equation*}
    \frac{\mathbf{L}_t^P}{L_t^P} = \frac{\text{diag}(\mathbf{1} - \bm{\alpha}) (\mu \mathbf{I} - \bm{\Omega}^{\top} \text{diag}(\bm{\alpha}))^{-1} \bm{\beta}}{\mathbf{1}^{\top} \text{diag}(\mathbf{1} - \bm{\alpha}) (\mu \mathbf{I} - \bm{\Omega}^{\top} \text{diag}(\bm{\alpha}))^{-1} \bm{\beta}}
\end{equation*}
where $\mu \equiv \theta / (\theta - 1)$ is the constant markup. Similarly, the share of entry labor allocated to each sector is given by:
\begin{equation*}
    \frac{\mathbf{L}_t^E}{L_t^E} = \frac{(\mu \mathbf{I} - \bm{\Omega}^{\top} \text{diag}(\bm{\alpha}))^{-1} \bm{\beta}}{\mathbf{1}^{\top} (\mu \mathbf{I} - \bm{\Omega}^{\top} \text{diag}(\bm{\alpha}))^{-1} \bm{\beta}}.
\end{equation*}

\subsection{The optimal allocation}

In Appendix \ref{a:optimal allocation}, we derive the optimal allocation of this economy. In particular, we show that on a balanced growth path, the share of production labor allocated to each sector is given by:
\begin{equation*}
    \frac{\mathbf{L}_t^P}{L_t^P} = \frac{\text{diag}(\mathbf{1} - \bm{\alpha}) (\mathbf{I} - \bm{\Omega}^{\top} \text{diag}(\bm{\alpha}))^{-1} \bm{\beta}}{\mathbf{1}^{\top} \text{diag}(\mathbf{1} - \bm{\alpha}) (\mathbf{I} - \bm{\Omega}^{\top} \text{diag}(\bm{\alpha}))^{-1} \bm{\beta}}
\end{equation*}
and the share of entry labor allocated to each sector is given by:
\begin{equation*}
    \frac{\mathbf{L}_t^E}{L_t^E} = \frac{(\bm{\Omega} \circ \bm{\Psi})^{\top} \text{diag}(\bm{\alpha}) (\mathbf{I} - \bm{\Omega}^{\top} \text{diag}(\bm{\alpha}))^{-1} \bm{\beta}}{\mathbf{1}^{\top} (\bm{\Omega} \circ \bm{\Psi})^{\top} \text{diag}(\bm{\alpha}) (\mathbf{I} - \bm{\Omega}^{\top} \text{diag}(\bm{\alpha}))^{-1} \bm{\beta}}.
\end{equation*}

\clearpage

\bibliography{../references}
\bibliographystyle{aer}

\clearpage
\renewcommand{\contentsname}{Appendix}
\addtocontents{toc}{\protect\setcounter{tocdepth}{2}}
\tableofcontents

\clearpage
\appendix
\numberwithin{equation}{section}
\renewcommand\thefigure{\thesection.\arabic{figure}}
\renewcommand\thetable{\thesection.\arabic{table}}

\section{Theoretical appendix}
\label{a:theoretical appendix}

\subsection{The optimal allocation}
\label{a:optimal allocation}

By symmetry across firms within sectors, we have:
\begin{equation*}
    C_{ist} = \frac{C_{st}}{M_{st}}, \quad l_{ist} = \frac{L_{st}^P}{M_{st}}, \quad \text{and} \quad x_{ist}(j, k) = \frac{x_{st}(k)}{M_{st} M_{kt}}.
\end{equation*}
Substituting these into the equations of Table \ref{tab:environment}, we have:
\begin{equation*}
    C_t = \prod_{s = 1}^S C_{st}^{\beta_s} \quad \text{where} \quad C_{st} = \prod_{k = 1}^S \left(x_{st}(k) M_{kt}^{\psi_{sk}}\right)^{\omega_{sk} \alpha_s} {L_{st}^P}^{1 - \alpha_s} - \sum_{k = 1}^S x_{kt}(s).
\end{equation*}
Therefore, the planner's static allocation problem is equivalent to:
\begin{align*}
    &\max_{C_{st}, x_{st}(k), L_{st}^P} \sum_{s = 1}^S \beta_s \ln(C_{st}) \\
    &\text{s.t.} \quad C_{st} = \prod_{k = 1}^S \left(x_{st}(k) M_{kt}^{\psi_{sk}}\right)^{\omega_{sk} \alpha_s} {L_{st}^P}^{1 - \alpha_s} - \sum_{k = 1}^S x_{kt}(s) \\
    &\text{s.t.} \quad \sum_{s = 1}^S L_{st}^P = \mathcal{S}^P N_t.
\end{align*}
The first-order conditions of this problem imply that:
\begin{equation*}
    x_{st}(k) = \frac{\beta_s \omega_{sk} \alpha_s Y_{st} C_{kt}}{\beta_k C_{st}} \quad \text{and} \quad \frac{(1 - \alpha_s) Y_{st}}{\lambda_t L_{st}^P} = \frac{C_{st}}{\beta_s}
\end{equation*}
where $\lambda_t$ denotes the Lagrange multiplier on the production labor resource constraint and aggregate output in sector $s$ is defined as:
\begin{equation}
    Y_{st} \equiv \prod_{k = 1}^S \left(x_{st}(k) M_{kt}^{\psi_{sk}}\right)^{\omega_{sk} \alpha_s} {L_{st}^P}^{1 - \alpha_s}. \label{eq:aggregate output}
\end{equation}
Using the problem's optimality conditions, we obtain an expression for the quantity of intermediate inputs from sector $k$ used by sector $s$:
\begin{equation}
    x_{st}(k) = \omega_{sk} \alpha_s Y_{kt} \cdot \frac{(1 - \alpha_k) L_{st}^P}{(1 - \alpha_s) L_{kt}^P}. \label{eq:intermediate inputs}
\end{equation}
Substituting this and the optimality condition for the production labor choice into the product resource constraint of sector $s$, and rearranging, we have:
\begin{equation*}
    \frac{\beta_s}{\lambda_t} = \frac{L_{st}^P}{(1 - \alpha_s)} - \sum_{k = 1}^S \frac{\omega_{ks} \alpha_k L_{kt}^P}{(1 - \alpha_k)}.
\end{equation*}
This expression can be rewritten in vector notation as:
\begin{equation*}
    \lambda_t \mathbf{L}_t^P = \text{diag}(\mathbf{1} - \bm{\alpha}) (\mathbf{I} - \bm{\Omega}^{\top} \text{diag}(\bm{\alpha}))^{-1} \bm{\beta}.
\end{equation*}
The multiplier $\lambda_t$ can be solved for by using the production labor resource constraint:
\begin{equation*}
    \lambda_t L_t^P = \mathbf{1}^{\top} \text{diag}(\mathbf{1} - \bm{\alpha}) (\mathbf{I} - \bm{\Omega}^{\top} \text{diag}(\bm{\alpha}))^{-1} \bm{\beta}.
\end{equation*}
Therefore, the share of production labor allocated to each sector is:
\begin{equation*}
    \frac{\mathbf{L}_t^P}{L_t^P} = \frac{\text{diag}(\mathbf{1} - \bm{\alpha}) (\mathbf{I} - \bm{\Omega}^{\top} \text{diag}(\bm{\alpha}))^{-1} \bm{\beta}}{\mathbf{1}^{\top} \text{diag}(\mathbf{1} - \bm{\alpha}) (\mathbf{I} - \bm{\Omega}^{\top} \text{diag}(\bm{\alpha}))^{-1} \bm{\beta}}.
\end{equation*}
Substituting equation \eqref{eq:intermediate inputs} in equation \eqref{eq:aggregate output}, we obtain an expression for the marginal product of production labor in sector $s$ as a function of the marginal product of production labor of its suppliers:
\begin{equation*}
    \frac{(1 - \alpha_s) Y_{st}}{L_{st}^P} \equiv (1 - \alpha_s)^{1 - \alpha_s} \prod_{k = 1}^S \left(\omega_{sk} \alpha_s M_{kt}^{\psi_{sk}} \cdot \frac{(1 - \alpha_k) Y_{kt}}{L_{kt}^P}\right)^{\omega_{sk} \alpha_s}.
\end{equation*}
Denoting these marginal products by $Y_{st}^L$ and taking logarithms, we can rewrite:
\begin{align*}
    \ln(Y_{st}^L) &= (1 - \alpha_s) \ln(1 - \alpha_s) + \alpha_s \ln(\alpha_s) + \alpha_s \sum_{k = 1}^S \omega_{sk} \ln(\omega_{sk}) \\
    &+ \alpha_s \sum_{k = 1}^S \omega_{sk} \psi_{sk} \ln(M_{kt}) + \alpha_s \sum_{k = 1}^S \omega_{sk} \ln(Y_{kt}^L).
\end{align*}
Defining $\hat{\mathbf{X}}$ as the element-wise logarithm of an arbitrary vector or matrix $\mathbf{X}$, we can rewrite in log-vector notation:
\begin{align*}
    \hat{\mathbf{Y}}_t^L &= (\mathbf{I} - \text{diag}(\bm{\alpha}) \bm{\Omega})^{-1} [\text{diag}(\mathbf{1} - \bm{\alpha}) \widehat{(\mathbf{1} - \bm{\alpha})} + \text{diag}(\bm{\alpha}) \hat{\bm{\alpha}} \\
    &+ \text{diag}(\bm{\alpha}) (\bm{\Omega} \circ \hat{\bm{\Omega}}) \mathbf{1} + \text{diag}(\bm{\alpha}) (\bm{\Omega} \circ \Psi) \hat{\mathbf{M}}_t]
\end{align*}
where $\circ$ denotes the Hadamard product. Using the definition of $Y_{st}^L$, we have:
\begin{align*}
    \hat{\mathbf{Y}}_t^L &= (\mathbf{I} - \text{diag}(\bm{\alpha}) \bm{\Omega})^{-1} [\text{diag}(\mathbf{1} - \bm{\alpha}) \widehat{(\mathbf{1} - \bm{\alpha})} + \text{diag}(\bm{\alpha}) \hat{\bm{\alpha}} \\
    &+ \text{diag}(\bm{\alpha}) (\bm{\Omega} \circ \hat{\bm{\Omega}}) \mathbf{1} + \text{diag}(\bm{\alpha}) (\bm{\Omega} \circ \Psi) \hat{\mathbf{M}}_t] + \hat{\mathbf{L}}_t^P - \widehat{(\mathbf{1} - \bm{\alpha})}.
\end{align*}
Substituting equation \eqref{eq:intermediate inputs} in the sectoral resource constraints, we have:
\begin{equation*}
    C_{st} = Y_{st} \left(1 - \frac{1 - \alpha_s}{L_{st}^P} \times \sum_{k = 1}^S \frac{\omega_{ks} \alpha_k L_{kt}^P}{1 - \alpha_k}\right).
\end{equation*}
In log-vector notation, we can analogously rewrite:
\begin{equation*}
    \hat{\mathbf{C}}_t = \hat{\mathbf{Y}}_t + \hat{\bm{\Gamma}}_t \quad \text{where} \quad \bm{\Gamma}_t \equiv \mathbf{1} - \text{diag}(\mathbf{1} - \bm{\alpha}) \text{diag}(\mathbf{L}_t^P)^{-1} \bm{\Omega}^{\top} \text{diag}(\bm{\alpha}) \text{diag}(\mathbf{1} - \bm{\alpha})^{-1} \mathbf{L}_t^P.
\end{equation*}
Therefore, the current-value Hamiltonian that corresponds to the planner's dynamic allocation problem is:
\begin{equation*}
    \mathcal{H}_t = \bm{\beta}^{\top} (\hat{\mathbf{Y}}_t + \hat{\bm{\Gamma}}_t) - \ln(N_t) + \sum_{s = 1}^S \mu_{st} \epsilon_s L_{st}^E + \lambda_t \left(L_t^E - \sum_{s = 1}^S L_{st}^E\right)
\end{equation*}
where $\mu_{st}$ are costate variables. The optimality conditions of this problem are:
\begin{align*}
    \partialof{\mathcal{H}_t}{L_{st}^E} &= \mu_{st} \epsilon_s - \lambda_t = 0, \\
    \partialof{\mathcal{H}_t}{M_{st}} &= \frac{\bm{\beta}^{\top} (\mathbf{I} - \text{diag}(\bm{\alpha}) \bm{\Omega})^{-1} \text{diag}(\bm{\alpha}) (\bm{\Omega} \circ \bm{\Psi}) \mathbf{e}_s}{M_{st}} = (\rho - n) \mu_{st} - \dot{\mu}_{st}.
\end{align*}

\paragraph{Balanced growth path.} On a balanced growth path, the measure of varieties within any sector must grow at rate $n$, which implies:
\begin{equation*}
    M_{st} = \frac{\epsilon_s L_{st}^E}{n}.
\end{equation*}
Using this result and the problem's optimality conditions, and rearranging, we have:
\begin{equation*}
    (\rho / n) \lambda_t L_{st}^E = \bm{\beta}^{\top} (\mathbf{I} - \text{diag}(\bm{\alpha}) \bm{\Omega})^{-1} \text{diag}(\bm{\alpha}) (\bm{\Omega} \circ \bm{\Psi}) \mathbf{e}_s.
\end{equation*}
The costate variable $\lambda_t$ is solved for by using the research labor resource constraint:
\begin{equation*}
    (\rho / n) \lambda_t L_t^E = \bm{\beta}^{\top} (\mathbf{I} - \text{diag}(\bm{\alpha}) \bm{\Omega})^{-1} \text{diag}(\bm{\alpha}) (\bm{\Omega} \circ \bm{\Psi}) \mathbf{1}.
\end{equation*}
Therefore, the share of entry labor allocated to each sector is:
\begin{equation*}
    \frac{\mathbf{L}_t^E}{L_t^E} = \frac{(\bm{\Omega} \circ \bm{\Psi})^{\top} \text{diag}(\bm{\alpha}) (\mathbf{I} - \bm{\Omega}^{\top} \text{diag}(\bm{\alpha}))^{-1} \bm{\beta}}{\mathbf{1}^{\top} (\bm{\Omega} \circ \bm{\Psi})^{\top} \text{diag}(\bm{\alpha}) (\mathbf{I} - \bm{\Omega}^{\top} \text{diag}(\bm{\alpha}))^{-1} \bm{\beta}}.
\end{equation*}

\subsection{The market equilibrium allocation}
\label{a:market equilibrium allocation}

\paragraph{The household's problem.} Taking prices and the measures of varieties as given, the representative household's problem is to choose its consumption $C_{ist}$ of each variety to maximize lifetime utility:
\begin{equation*}
    U = \max_{C_{ist}} \int_0^{\infty} e^{-(\rho - n) t} \ln(c_t) \text{d}t \quad \text{where} \quad C_t = \prod_{s = 1}^S \left(M_{st}^{-1 / \theta} \int_0^{M_{st}} C_{ist}^{\frac{\theta - 1}{\theta}} \text{d}i\right)^{\frac{\beta_s \theta}{\theta - 1}}
\end{equation*}
subject to the flow budget constraint:
\begin{equation*}
    \dot{A}_t = r_t A_t + w_t^P L_t^P + w_t^E L_t^E - \sum_{s = 1}^S \int_0^{M_{st}} p_{ist} C_{ist} \text{d}i
\end{equation*}
where $A_t$ is financial wealth at time $t$, $w_t^P$ and $w_t^E$ are the wages paid to production and entry labor, respectively, and $p_{ist}$ is the price of product $i$ from sector $s$. Choosing aggregate consumption as the num\'eraire, this problem delivers the usual Euler equation and final demand functions:
\begin{equation*}
    \frac{\dot{c}_t}{c_t} = r_t - \rho \quad \text{and} \quad C_{ist} = \frac{\beta_s C_t P_{st}^{\theta - 1}}{M_{st} p_{ist}^{\theta}}, \quad \forall i \in [0, M_{st}], \smallquad \forall s \in \{1, \ldots, S\}
\end{equation*}
where $c_t \equiv C_t / N_t$ and $P_{st}$ is the ideal price index of final consumption from sector $s$:
\begin{equation*}
    P_{st} \equiv \left(M_{st}^{-1} \int_0^{M_{st}} p_{ist}^{1 - \theta} \text{d}i\right)^{\frac{1}{1 - \theta}} \quad \forall s \in \{1, \ldots, S\}.
\end{equation*}
Similarly, the ideal price index of aggregate consumption, denoted as $P_t$, is normalized to unity and is defined as:
\begin{equation*}
    P_t \equiv \prod_{s = 1}^S \left(\frac{P_{st}}{\beta_s}\right)^{\beta_s}.
\end{equation*}

\paragraph{The firm's problem.} After entry, a firm engages in monopolistic competition on the output market and perfect competition on the markets for inputs. That is, it chooses a price as well as intermediate inputs and production labor to maximize profits $\pi_{ist}$ while taking as given the demand for its product, the price $p_{jkt}$ of intermediate inputs, and the production wage:
\begin{equation*}
    \pi_{ist} = \max_{p_{ist}, x_{ist}(j, k), l_{ist}}\{p_{ist} y_{ist} - \sum_{k = 1}^S \int_0^{M_{kt}} p_{jkt} x_{ist}(j, k) \text{d}j - w_t^P l_{ist}\}.
\end{equation*}
This can be broken down into several sub-problems. The first being the following cost minimization problem for each supplying sector $k$:
\begin{equation*}
    \min_{x_{ist}(j, k)} \int_0^{M_{kt}} p_{jkt} x_{ist}(j, k) \text{d}j \quad \text{s.t.} \quad M_{kt}^{\psi_{sk}} \left(M_{kt}^{-1 / \theta} \int_0^{M_{kt}} x_{ist}(j, k)^{\frac{\theta - 1}{\theta}} \text{d}j\right)^{\frac{\theta}{\theta - 1}} \geq x_{ist}(k).
\end{equation*}
The first-order conditions deliver the following demand functions:
\begin{equation*}
    x_{ist}(j, k) = (P_{st}^X(k) / p_{jkt})^{\theta} M_{kt}^{\psi_{sk} (\theta - 1) - 1} x_{ist}(k) \quad \text{where} \quad P_{st}^X(k) \equiv P_{kt} M_{kt}^{-\psi_{sk}}.
\end{equation*}
The second sub-problem is the following cost minimization problem:
\begin{equation*}
    \min_{x_{ist}(k)} \sum_{k = 1}^S P_{st}^X(k) x_{ist}(k) \quad \text{s.t.} \quad \prod_{k = 1}^S x_{ist}(k)^{\omega_{sk}} \geq x_{ist}.
\end{equation*}
The first-order conditions deliver the following demand functions:
\begin{equation*}
    x_{ist}(k) = \omega_{sk} P_{st}^X x_{ist} / P_{st}^X(k) \quad \text{where} \quad P_{st}^X \equiv \prod_{k = 1}^S \left(\frac{P_{st}^X(k)}{\omega_{sk}}\right)^{\omega_{sk}}.
\end{equation*}
The third sub-problem is the following cost minimization problem:
\begin{equation*}
    \min_{x_{ist}, l_{ist}}\{P_{st}^X x_{ist} + w_t^P l_{ist}\} \quad \text{s.t.} \quad x_{ist}^{\alpha_s} l_{ist}^{1 - \alpha_s} \geq y_{ist}.
\end{equation*}
The first-order conditions deliver the following demand functions:
\begin{equation*}
    x_{ist} = \alpha_s m_{st} y_{ist} / P_{st}^X \quad \text{and} \quad l_{ist} = (1 - \alpha_s) m_{st} y_{ist} / w_t^P
\end{equation*}
where $m_{st}$ denotes the marginal cost of firms in sector $s$:
\begin{equation*}
    m_{st} \equiv \left(\frac{P_{st}^X}{\alpha_s}\right)^{\alpha_s} \left(\frac{w_t^P}{1 - \alpha_s}\right)^{1 - \alpha_s}.
\end{equation*}
The last sub-problem is the firm's optimal pricing problem. It is straightforward to show that firms set their price to a constant markup $\mu$ above marginal cost:
\begin{equation*}
    p_{ist} = \mu \cdot m_{st} \quad \text{where} \quad \mu \equiv \frac{\theta}{\theta - 1}.
\end{equation*}
Therefore, firm profits in sector $s$ are given by:
\begin{equation*}
    \pi_{ist} = \frac{m_{st} y_{ist}}{\theta - 1}.
\end{equation*}
Substituting the demand function for intermediate inputs in the firm's production function and solving for the output of firm $i$ in sector $s$, we have:
\begin{equation*}
    y_{ist} = (\alpha_s m_{st} / P_{st}^X)^{\frac{\alpha_s}{1 - \alpha_s}} l_{ist}.
\end{equation*}
Using the symmetry of production labor demand functions as well as the definition of the firm's marginal cost, we can rewrite:
\begin{equation*}
    y_{ist} = \left[\frac{\alpha_s w_t^P}{(1 - \alpha_s) P_{st}^X}\right]^{\alpha_s} L_{st}^P / M_{st}.
\end{equation*}
Therefore, firm profits in sector $s$ are given by:
\begin{equation*}
    \pi_{ist} = \frac{w_t^P L_{st}}{(1 - \alpha_s) (\theta - 1) M_{st}}, \quad \forall i \in [0, M_{st}], \smallquad \forall s \in \{1, \ldots, S\}.
\end{equation*}
The value of such a firm is given by the present value of its future profits:
\begin{equation*}
    V_{st} = \int_t^{\infty} e^{-\int_t^{t^{\prime}} r_{\tau} \text{d}\tau} \pi_{st^{\prime}} \text{d}t^{\prime} \quad \forall s \in \{1, \ldots, S\}.
\end{equation*}
Differentiating $V_{st}$ with respect to time, we obtain the law of motion for the value of a firm in sector $s$:
\begin{equation*}
    \dot{V}_{st} = r_t V_{st} - \frac{w_t^P L_{st}^P}{(1 - \alpha_s) (\theta - 1) M_{st}} \quad \forall s \in \{1, \ldots, S\}.
\end{equation*}

\paragraph{The entrant's problem.} The entrant's problem is to choose entry labor to maximize the expected present discounted value of introducing a new product:
\begin{equation*}
    \max_{L_{st}^E} \{V_{st} \epsilon_s L_{st}^E - w_t^E L_{st}^E\} \quad \forall s \in \{1, \ldots, S\}.
\end{equation*}
With free-entry among potential entrants, this implies:
\begin{equation*}
    V_{st} = w_t^E / \epsilon_s \quad \forall s \in \{1, \ldots, S\}.
\end{equation*}

\paragraph{Equilibrium.} The asset market clearing condition is:
\begin{equation*}
    A_t = \sum_{s = 1}^S V_{st} M_{st}.
\end{equation*}
Differentiating with respect to time delivers:
\begin{equation*}
    \dot{A}_t = \sum_{s = 1}^S \dot{V}_{st} M_{st} + \sum_{s = 1}^S V_{st} \dot{M}_{st} = r_t A_t - \sum_{s = 1}^S \frac{w_t^P L_{st}^P}{(1 - \alpha_s) (\theta - 1)} + w_t^E L_t^E.
\end{equation*}
Combining this result with the household's flow budget constraint, we have:
\begin{equation*}
    C_t = w_t^P \sum_{s = 1}^S L_{st}^P \left(\frac{(1 - \alpha_s) (\theta - 1) + 1}{(1 - \alpha_s) (\theta - 1)}\right).
\end{equation*}
Taking the logarithm of the ideal price index of aggregate consumption, we have:
\begin{equation*}
    \sum_{s = 1}^S \beta_s [\ln(P_{st}) - \ln(\beta_s)] = 0.
\end{equation*}
Substituting in the expressions for $P_{st}$, we have:
\begin{equation*}
    \ln(\mu) + \sum_{s = 1}^S \beta_s [\alpha_s \ln(P_{st}^X) - \alpha_s \ln(\alpha_s) + (1 - \alpha_s) \ln(w_t^P) - (1 - \alpha_s) \ln(1 - \alpha_s) - \ln(\beta_s)] = 0.
\end{equation*}
In log-vector notation, we have:
\begin{equation*}
    \ln(\mu) + \bm{\beta}^{\top} [\text{diag}(\bm{\alpha}) \hat{\mathbf{P}}_t^X - \text{diag}(\bm{\alpha}) \hat{\bm{\alpha}} + \ln(w_t^P) \text{diag}(\mathbf{1} - \bm{\alpha}) - \text{diag}(\mathbf{1} - \bm{\alpha}) \widehat{(\mathbf{1} - \bm{\alpha})} - \hat{\bm{\beta}}] = 0.
\end{equation*}
Using the expressions for $P_{st}^X$ and taking logarithms, we have:
\begin{align*}
    \ln(P_{st}^X) &= \ln(\mu) + \sum_{k = 1}^S \omega_{sk} [\alpha_k \ln(P_{kt}^X) - \alpha_k \ln(\alpha_k) \\
    &+ (1 - \alpha_k) \ln(w_t^P) - (1 - \alpha_k) \ln(1 - \alpha_k) - \psi_{sk} \ln(M_{kt}) - \ln(\omega_{sk})].
\end{align*}
In log-vector notation, we can solve for $\hat{\mathbf{P}}_t^X$:
\begin{align*}
    \hat{\mathbf{P}}_t^X &= (\mathbf{I} - \bm{\Omega} \text{diag}(\bm{\alpha}))^{-1} [\ln(\mu) \mathbf{1} + \bm{\Omega} (\ln(w_t^P) (\mathbf{1} - \bm{\alpha}) - \text{diag}(\bm{\alpha}) \hat{\bm{\alpha}} - \text{diag}(\mathbf{1} - \bm{\alpha}) \widehat{(\mathbf{1} - \bm{\alpha})}) \\
    &- (\bm{\Omega} \circ \hat{\bm{\Omega}}) \mathbf{1} - (\bm{\Omega} \circ \bm{\Psi}) \hat{\mathbf{M}}_t].
\end{align*}
Substituting this expression in the previous equation delivers an expression for the logarithm of the wage paid to production workers as a function of the measures of varieties.

\paragraph{Balanced growth path.} On a balanced growth path, it must be that the measure of varieties within each sector grows at the same rate as the population, which implies:
\begin{align*}
    M_{st} = \frac{\epsilon_s L_{st}^E}{n} \quad \forall s \in \{1, \ldots, S\}.
\end{align*}
Similarly, the growth rate of the value of a firm must be equal to the growth rate of consumption per person, which implies:
\begin{equation*}
    V_{st} = \frac{w_t^P L_{st}^P}{\rho (1 - \alpha_s) (\theta - 1) M_{st}}, \quad \forall s \in \{1, \ldots, S\}.
\end{equation*}
Using the free-entry condition and the BGP measure of products, we have:
\begin{equation*}
    L_{st}^E = \frac{n w_t^P L_{st}^P}{\rho (1 - \alpha_s) (\theta - 1) w_t^E}, \quad \forall s \in \{1, \ldots, S\}.
\end{equation*}
Imposing the entry labor resource constraint, we obtain an expression for the wage paid to entry labor:
\begin{equation*}
    w_t^E = \frac{n w_t^P}{\rho (\theta - 1) L_t^E} \cdot \sum_{s = 1}^S \frac{L_{st}^P}{1 - \alpha_s}.
\end{equation*}
Substituting this back into the previous equation, we obtain an expression for the share of entry labor in each sector in vector notation:
\begin{equation*}
    \frac{\mathbf{L}_t^E}{L_t^E} = \frac{\text{diag}(\mathbf{1} - \bm{\alpha})^{-1} \mathbf{L}_t^P}{\mathbf{1}^{\top} \text{diag}(\mathbf{1} - \bm{\alpha})^{-1} \mathbf{L}_t^P}.
\end{equation*}
The product resource constraints are:
\begin{equation*}
    C_{ist} = y_{ist} - \sum_{k = 1}^S \int_0^{M_{kt}} x_{jkt}(i, s) \text{d}j \quad \forall i \in [0, M_{st}], \smallquad \forall s \in \{1, \ldots, S\}.
\end{equation*}
Multiplying both sides of this equation by $p_{ist}$ and substituting in the final and intermediate demand functions, as well as the expression for the output of firm $i$ in sector $s$, we have:
\begin{equation*}
    \beta_s C_t = \frac{\mu w_t^P L_{st}^P}{1 - \alpha_s} - w_t^P \sum_{k = 1}^S \frac{\omega_{ks} \alpha_k L_{kt}^P}{1 - \alpha_k} \quad \forall s \in \{1, \ldots, S\}.
\end{equation*}
This equation can be rewritten in vector notation as:
\begin{equation*}
    \frac{w_t^P \mathbf{L}_t^P}{C_t} = [\mu \text{diag}(\mathbf{1} - \bm{\alpha})^{-1} - \bm{\Omega}^{\top} \text{diag}(\bm{\alpha}) \text{diag}(\mathbf{1} - \bm{\alpha})^{-1}]^{-1} \bm{\beta}.
\end{equation*}
Imposing the production labor resource constraint, we obtain an expression for the payments to production labor as a share of aggregate consumption:
\begin{equation*}
    \frac{w_t^P L_t^P}{C_t} = \mathbf{1}^{\top} [\mu \text{diag}(\mathbf{1} - \bm{\alpha})^{-1} - \bm{\Omega}^{\top} \text{diag}(\bm{\alpha}) \text{diag}(\mathbf{1} - \bm{\alpha})^{-1}]^{-1} \bm{\beta}.
\end{equation*}
Substituting this back into the previous equation, we obtain an expression for the share of production labor in each sector:
\begin{equation*}
    \frac{\mathbf{L}_t^P}{L_t^P} = \frac{\text{diag}(\mathbf{1} - \bm{\alpha}) (\mu \mathbf{I} - \bm{\Omega}^{\top} \text{diag}(\bm{\alpha}))^{-1} \bm{\beta}}{\mathbf{1}^{\top} \text{diag}(\mathbf{1} - \bm{\alpha}) (\mu \mathbf{I} - \bm{\Omega}^{\top} \text{diag}(\bm{\alpha}))^{-1} \bm{\beta}}.
\end{equation*}
Substituting this back into the expression for the share of entry labor in each sector, we have the following:
\begin{equation*}
    \frac{\mathbf{L}_t^E}{L_t^E} = \frac{(\mu \mathbf{I} - \bm{\Omega}^{\top} \text{diag}(\bm{\alpha}))^{-1} \bm{\beta}}{\mathbf{1}^{\top} (\mu \mathbf{I} - \bm{\Omega}^{\top} \text{diag}(\bm{\alpha}))^{-1} \bm{\beta}}.
\end{equation*}

\end{document}